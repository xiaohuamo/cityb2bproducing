<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<link rel="stylesheet" type="text/css" href="__STATIC__/product/css/common.css"/>
		<script src="__STATIC__/product/js/jquery-3.3.1.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="__STATIC__/product/js/vue.min.js"></script>
		<script src="__STATIC__/product/js/common.js"></script>
	</head>
	<body>
	<div id="main" v-cloak @click="closePop();isDo()">
		<div class="bgfff H120 head flexbox1 f35">
			<div class="flexbox2">
				<img src="__STATIC__/product/img/headIcon.png" class="headIcon"/>&nbsp;
				<span>City b2b</span>
			</div>
		    <div class="relative hand" @click.stop="chose(1)">
				{{choseDate1?choseDate1.date+' '+choseDate1.date_day:list[0].date+' '+choseDate1.date_day}}
				<div class="choseCustomerBox datePop" v-show="whichPopShow==1">
					<div class="mb10" v-for="(item,index) in list" :class="currentDay==index?'colFD6921':''" @click.stop="choseDay(item,index)">{{item.date}} {{item.date_day}}</div>
				</div>
			</div>
			<div class="flexbox2 relative hand" @click.stop="chose(2)">
				{{choseDate2?choseDate2:list2[0]}}
				<img src="__STATIC__/product/img/updown.png" class="updown"/>
				<div class="choseCustomerBox" v-show="whichPopShow==2">
					<div class="mb10" v-for="(item,index) in list2" :class="current2==index?'colFD6921':''" @click.stop="choseCus(item,index)">{{item}}</div>
				</div>
			</div>
			<div class="flexbox2 relative hand" @click.stop="chose(3)">
				{{choseDate3?choseDate3.name:list3[0].name}}
				<img src="__STATIC__/product/img/updown.png" class="updown"/>
				<div class="choseCustomerBox" v-show="whichPopShow==3">
					<div class="mb10" v-for="(item,index) in list3" :class="current3==index?'colFD6921':''" @click.stop="choseDriver(item,index)">{{item.name}}</div>
				</div>
			</div>

			<div class="btn bgFD6921">{{driverOrderDoneNum}}/{{driverOrderNum}}</div>
			<div class="btn bg34C079">{{orderDoneNum}}/{{orderNum}}</div>
		</div>

		<div class="flexbox3" style="min-height:100%;">
			<div class="left bgfff">
				<div class="colfff f32 jbBG flexbox2 goodsMenu hand" @click="returnPage(2)" v-show="currentPage==1">
					<img src="__STATIC__/product/img/goodsIcon.png" class="goodsIcon"/>
					Product List
					<img src="__STATIC__/product/img/arrow.png" class="arrIcon"/>
				</div>
				<div class="colfff f32 jbBG flexbox2 goodsMenu hand" @click="returnPage(1)" v-show="currentPage==2">
					<img src="__STATIC__/product/img/return.png" class="returnIcon"/>
					Return
				</div>
				<div class="f35 bgF1F1F1 lbtn hand" v-show="currentPage==1" @click="clickHandle">
					<span class="colFD6921" v-if="isHandle==0">waitting-process</span>
					<span class="col34C079" v-else-if="isHandle==1">processed</span>
					<span class="col000" v-else>number</span>
					<img src="__STATIC__/product/img/updown.png" class="updown"/>
				</div>
				<div v-for="(item,index) in menudata" :class="currentMenu==index?'bgFD6921 colfff':'bgF1F1F1 col000'" class="f35 lbtn relative hand" v-show="currentPage==2" @click="clickMenu(index)">
					{{item}}
					<img src="__STATIC__/product/img/menusj.png" class="menusj" v-show="currentMenu==index"/>
				</div>

				<div v-show="currentPage==1" class="hand leftMenu">
					<div :class="item.status==0?'bgFD6921':item.status==3?'bg34C079':'bgFD6921'" class="colfff f35 lbtn2 relative" v-for="(item,index) in menudata2" @click="clickGoods(item,index)">
						<span :class="item.staus==2?'blink':''">{{item.menu_en_name}}</span>
						<div :class="item.staus==2?'blink':''">{{item.product_id}}</div>
					</div>
<!--					<div class="colfff f35 bgB5B5B5 lbtn2 relative">-->
<!--						猪肉-->
<!--						<div>324324</div>-->
<!--						<img src="__STATIC__/product/img/suo.png" class="suo"/>-->
<!--					</div>-->

				</div>
			</div>
			<div class="right pa20">
				<div v-show="currentPage==1">
					<div>
						<div class="flexbox2 rsection1">
							<div :class="item.status==0?'bgOrange':item.status==3?'bgGreen':'bgOrange'" class="colfff rbtn" v-for="(item,index) in menudataTwoCate">
								<div :class="item.staus==2?'blink':''">{{item.guige_name}}</div>
								<div :class="item.staus==2?'blink':''">{{item.finish_quantities}}/{{item.sum_quantities}}{{item.unit_en}}</div>
							</div>
<!--							<div class="bgGrey colfff rbtn">-->
<!--								<div class="textLeft f25">5mm</div>-->
<!--								<div class="textCenter maT10 f30">15/78kg</div>-->
<!--							</div>-->
<!--							<div class="bgdarkGrey colfff rbtn">-->
<!--								<div class="textLeft f25">5mm</div>-->
<!--								<div class="textCenter maT10 f30">15/78kg</div>-->
<!--							</div>-->
<!--							<div class="bgOrange colfff rbtn">-->
<!--								<div class="textLeft f25">5mm</div>-->
<!--								<div class="textCenter maT10 f30">15/78kg</div>-->
<!--							</div>-->
<!--							<div class="bgGreen colfff rbtn">-->
<!--								<div class="blink">-->
<!--									<div class="textLeft f25">5mm</div>-->
<!--									<div class="textCenter maT10 f30">15/78kg</div>-->
<!--								</div>-->
<!--							</div>-->
						</div>
<!--						<div class="flexbox2 rsection2">-->
<!--							<div class="rbtn2 bgdarkGrey">-->
<!--								1kg-->
<!--							</div>-->
<!--							<div class="rbtn2 bgOrange">-->
<!--								1kg-->
<!--							</div>-->
<!--						</div>-->
						<!-- 下面开始 -->
						<div class="rsection3 bgfff">
							<!-- 头部 -->
							<div class="flexbox1 pa20">
								<div class="flexbox2">
									<div class="flexbox1 xxBox" @click.stop="tab(0)">
										物流号<img src="__STATIC__/product/img/xxx.png" class="xxx"/>
									</div>
									<div class="flexbox1 xxBox" @click.stop="tab(1)">
										处理中<img src="__STATIC__/product/img/xxx.png" class="xxx"/>
									</div>
									<div class="flexbox1 xxBox" @click.stop="tab(2)">
										已处理<img src="__STATIC__/product/img/xxx.png" class="xxx"/>
									</div>
								</div>
								<div class="flexbox2 relative hand">
									<span @click="popKeyboard">
										<span>{{userName}}</span>&nbsp;&nbsp;
										<img src="__STATIC__/product/img/suo2.png" class="suo2"/>
									</span>
									<span class="colFD6921" v-if="isShowLoginOut" @click="LogOut" style="margin-left:25px;">&nbspLogout</span>
								</div>
							</div>
							<!-- 主体部分 -->
							<div class="mainBox" v-show="currentTab==0">
								<div class="flexbox1 mb15" v-for="(item,index) in handleList">
									<div class="flexbox1 pa5-10 w70" :class="item.bg">
										<div class="flexbox2">
											<div class="col666 F36" style="width: 50px;">16</div>
											<div class="col666 f35" style="width: 350px;">zhonghua001</div>
										</div>
										<div class="flexbox2">
											<img src="__STATIC__/product/img/disable.png" class="numicon" v-if="item.num==0"/>
											<img src="__STATIC__/product/img/reduce.png" class="numicon" @click="reduce(0,index,0)" v-else/>
											<input class="inputW" v-model="item.num"/><span class="col666 f25">kg</span>&nbsp;&nbsp;
											<img src="__STATIC__/product/img/add.png" class="numicon" @click="add(0,index,0)"/>
										</div>
									</div>
									<div class="flexbox1 pa18-0" :class="item.bg">
										<div class="flexbox2">
											<img src="__STATIC__/product/img/disable.png" class="numicon" v-if="item.num1==0"/>
											<img src="__STATIC__/product/img/reduce.png" class="numicon" @click="reduce(0,index,1)" v-else/>
											<input class="inputW" v-model="item.num1"/>
											<img src="__STATIC__/product/img/add.png" class="numicon" @click="add(0,index,1)"/>
										</div>
										<img src="__STATIC__/product/img/echo.png" class="echo" @click="changeStatus(0,item.status,index)"/>
									</div>
									<div class="rbtn3 bg34C079 relative" v-if="item.status==0" @click="handle(index)">
										已处理
										<div class="choseCustomerBox" style="width:90%;left:5%;padding:10px 0;" v-show="currentHandlePop==index">
											<div class="colFD6921" @click.stop="Popcontinue(0,index)">继续处理</div>
											<div class="mb10 col000" @click.stop="Popreturn">返回</div>
										</div>
									</div>
									<div class="rbtn3 bgFD6921" v-else @click="changeStatus(0,item.status,index)">
										待处理
									</div>
								</div>
							</div>
							<div class="mainBox" v-show="currentTab==1">
								<div class="flexbox1 mb15" v-for="(item,index) in handleList1">
									<div class="flexbox1 pa5-10 w70" :class="item.bg">
										<div class="flexbox2">
											<div class="col666 F36" style="width: 50px;">16</div>
											<div class="col666 f35" style="width: 350px;">zhonghua001</div>
										</div>
										<div class="flexbox2">
											<img src="__STATIC__/product/img/disable.png" class="numicon" v-if="item.num==0"/>
											<img src="__STATIC__/product/img/reduce.png" class="numicon" @click="reduce(1,index,0)" v-else/>
											<input class="inputW" v-model="item.num"/><span class="col666 f25">kg</span>&nbsp;&nbsp;
											<img src="__STATIC__/product/img/add.png" class="numicon" @click="add(1,index,0)"/>
										</div>
									</div>
									<div class="flexbox1 pa18-0" :class="item.bg">
										<div class="flexbox2">
											<img src="__STATIC__/product/img/disable.png" class="numicon" v-if="item.num1==0"/>
											<img src="__STATIC__/product/img/reduce.png" class="numicon" @click="reduce(1,index,1)" v-else/>
											<input class="inputW" v-model="item.num1"/>
											<img src="__STATIC__/product/img/add.png" class="numicon" @click="add(1,index,1)"/>
										</div>
										<img src="__STATIC__/product/img/echo.png" class="echo" @click="changeStatus(1,item.status,index)"/>
									</div>
									<div class="rbtn3 bgFD6921" v-if="item.status==1" @click="changeStatus(0,item.status,index)">
										待处理
									</div>
									<div class="rbtn3 bg34C079 relative" v-else @click="handle(index)">
										已处理
										<div class="choseCustomerBox" style="width:90%;left:5%;padding:10px 0;" v-show="currentHandlePop==index">
											<div class="colFD6921" @click.stop="Popcontinue(1,index)">继续处理</div>
											<div class="mb10 col000" @click.stop="Popreturn">返回</div>
										</div>
									</div>
								</div>
							</div>
							<div class="mainBox" v-show="currentTab==2">
								<div class="flexbox1 mb15" v-for="(item,index) in handleList2">
									<div class="flexbox1 pa5-10 w70" :class="item.bg">
										<div class="flexbox2">
											<div class="col666 F36" style="width: 50px;">16</div>
											<div class="col666 f35" style="width: 350px;">zhonghua001</div>
										</div>
										<div class="flexbox2">
											<img src="__STATIC__/product/img/disable.png" class="numicon" v-if="item.num==0"/>
											<img src="__STATIC__/product/img/reduce.png" class="numicon" @click="reduce(2,index,0)" v-else/>
											<input class="inputW" v-model="item.num"/><span class="col666 f25">kg</span>&nbsp;&nbsp;
											<img src="__STATIC__/product/img/add.png" class="numicon" @click="add(2,index,0)"/>
										</div>
									</div>
									<div class="flexbox1 pa18-0" :class="item.bg">
										<div class="flexbox2">
											<img src="__STATIC__/product/img/disable.png" class="numicon" v-if="item.num1==0"/>
											<img src="__STATIC__/product/img/reduce.png" class="numicon" @click="reduce(2,index,1)" v-else/>
											<input class="inputW" v-model="item.num1"/>
											<img src="__STATIC__/product/img/add.png" class="numicon" @click="add(2,index,1)"/>
										</div>
										<img src="__STATIC__/product/img/echo.png" class="echo" @click="changeStatus(2,item.status,index)"/>
									</div>
									<div class="rbtn3 bg34C079 relative" v-if="item.status==0"  @click="handle(index)">
										已处理
										<div class="choseCustomerBox" style="width:90%;left:5%;padding:10px 0;" v-show="currentHandlePop==index">
											<div class="colFD6921" @click.stop="Popcontinue(2,index)">继续处理</div>
											<div class="mb10 col000" @click.stop="Popreturn">返回</div>
										</div>
									</div>
									<div class="rbtn3 bgFD6921" v-if="item.status==1" @click="changeStatus(2,item.status,index)">
										待处理
									</div>
								</div>
							</div>
						</div>
						<!-- 下面结束 -->
					</div>
				</div>
				<div v-show="currentPage==2">
					<div style="padding:15px 0;font-weight:bold;" class="bgfff mb15 textCenter f35 colFD6921 relative hand" @click="returnPage(1)">
						<img src="__STATIC__/product/img/return2.png" style="width:11px;position:absolute;left:15px;"/>
						返回该类别
					</div>
					<div class="flexbox2">
						<div v-for="(item,index) in goods">
							<div class="rbtn2 bgOrange">
								猪肉
							</div>
							<div class="f24 col000 flexbox4 bgfff zdBox" v-show="currentMenu==1&&currentPage==2" @click="cancelZD(index)">
								<img src="__STATIC__/product/img/zd.png" class="zd"/>
								 取消置顶
							</div>
							<div class="f24 col000 flexbox4 bgfff zdBox" v-show="currentMenu==2&&currentPage==2" @click="cancelZD(index)">
								 <img src="__STATIC__/product/img/zd2.png" class="zd"/>
								 置顶
							</div>

						</div>
					</div>
				</div>
			</div>
		</div>
		<!-- 主体部分结束 -->

		<div class="mask" v-if="iskeyboardShow" @click="closeKeyboard">
			<div class="keyboardBox">
				<div class="tips" v-show="isPsdCorrect">{{message}}</div>
				<div v-if="isShowTypePincode1">
					<div class="keyboard input J_pincode" :class="{'keyboardBorder':focusDatype==10}" tabindex="0" :placeholder="placeholderPincode" @focus="focusData($event,10,1)">{{psd2}}</div>
				</div>
				<div v-if="isShowTypePincode2">
					<div class="keyboard input J_n_pincode" :class="{'keyboardBorder':focusDatype==20}" tabindex="0" :placeholder="placeholderNPincode" @focus="focusData($event,20,2)">{{npsd2}}</div>
					<div class="keyboard input J_nr_pincode" :class="{'keyboardBorder':focusDatype==30}" tabindex="0" :placeholder="placeholderNRPincode" @focus="focusData($event,30,2)">{{nrpsd2}}</div>
				</div>
				<div v-if="isShowTypePincode3">
					<div class="keyboard input J_o_pincode" :class="{'keyboardBorder':focusDatype==10}" tabindex="0" :placeholder="placeholderOPincode" @focus="focusData($event,10,3)">{{psd2}}</div>
					<div class="keyboard input J_n_pincode" :class="{'keyboardBorder':focusDatype==20}" tabindex="0" :placeholder="placeholderNPincode" @focus="focusData($event,20,3)">{{npsd2}}</div>
					<div class="keyboard input J_nr_pincode" :class="{'keyboardBorder':focusDatype==30}" tabindex="0" :placeholder="placeholderNRPincode" @focus="focusData($event,30,3)">{{nrpsd2}}</div>
				</div>
				<div>
					<div class="textRight w100 bgF7F7F7 save" :class="{'flexbox1':!isShowTypePincode2}">
						<span v-if="!isShowTypePincode2" @click.stop="editPincode">{{editText}}</span>
						<span @click.stop="save">Done</span>
					</div>
					<div class="flexbox1 pa10" style="background: #F2F2F2;">
						<div class="textCenter number" v-for="number in numberList" @click.stop="clickNum(number)">{{number}}</div>
						<div class="textCenter number" @click.stop="deletePsd">
							<img src="__STATIC__/product/img/delete.png" class="delete">
						</div>
					</div>
				</div>
			</div>
		</div>

	</div>
	</body>
	<script>
		new Vue({
			el:"#main",
			data:{
				currentHandlePop:-1,
				currentContent:0,
				currentDay:0,
				current2:0,
				current3:0,
				choseDate1:'',
				choseDate2:'',
				choseDate3:'',
				logistic_delivery_date:'',//筛选日期
				logistic_driver_no:'',//筛选司机
				list:[],
				list2:['All customers'],
				list3:[{"logistic_driver_no":"","name":"All drivers","nickname":""}],
				driverOrderDoneNum:0,//对应司机已完成订单数
				driverOrderNum:0,//对应司机全部订单数
				orderDoneNum:0,//订单已完成数
				orderNum:0,//订单总数
				num:20,
				whichPopShow:-1,
				currentPage:1,  // 1表示1级页面 2是2级页面
				menudata:['当前备货','置顶','猪肉','牛肉','羊肉'],
				menudata2:[],//加工产品
				menudataTwoCate:[],//二级产品类目
				currentTab:0,
				handleList:[
					{
						num:10,
						num1:1,
						bg:'bgF0FBFB',
						status:1    // 0已处理  1未处理
					},
					{
						num:10,
						num1:1,
						bg:'bgFFF7F3',
						status:0

					},
					{
						num:10,
						num1:1,
						bg:'bgF0FBFB',
						status:0

					},
					{
						num:10,
						num1:1,
						bg:'bgFFF7F3',
						status:0

					},
					{
						num:10,
						num1:1,
						bg:'bgF0FBFB',
						status:0

					},
					{
						num:10,
						num1:1,
						bg:'bgFFF7F3',
						status:0

					},
					{
						num:10,
						num1:1,
						bg:'bgF0FBFB',
						status:0

					},
					{
						num:10,
						num1:1,
						bg:'bgFFF7F3',
						status:0

					},
					{
						num:10,
						num1:1,
						bg:'bgF0FBFB',
						status:0

					},
					{
						num:10,
						num1:1,
						bg:'bgFFF7F3',
						status:0

					},
					{
						num:10,
						num1:1,
						bg:'bgF0FBFB',
						status:0

					},
					{
						num:10,
						num1:1,
						bg:'bgFFF7F3',
						status:0

					},
					{
						num:10,
						num1:1,
						bg:'bgF0FBFB',
						status:1
					}
				],
				handleList1:[
					{
						num:10,
						num1:1,
						bg:'bgF0FBFB',
						status:1    // 0已处理  1未处理
					},
					{
						num:10,
						num1:1,
						bg:'bgFFF7F3',
						status:1

					},
					{
						num:10,
						num1:1,
						bg:'bgF0FBFB',
						status:0

					},
					{
						num:10,
						num1:1,
						bg:'bgFFF7F3',
						status:0

					},
					{
						num:10,
						num1:1,
						bg:'bgF0FBFB',
						status:0

					},
					{
						num:10,
						num1:1,
						bg:'bgFFF7F3',
						status:0

					},
					{
						num:10,
						num1:1,
						bg:'bgF0FBFB',
						status:0

					},
					{
						num:10,
						num1:1,
						bg:'bgFFF7F3',
						status:0

					},{
						num:10,
						num1:1,
						bg:'bgF0FBFB',
						status:0

					},{
						num:10,
						num1:1,
						bg:'bgFFF7F3',
						status:0

					},{
						num:10,
						num1:1,
						bg:'bgF0FBFB',
						status:0

					},
					{
						num:10,
						num1:1,
						bg:'bgFFF7F3',
						status:1
					}
				],
				handleList2:[
					{
						num:10,
						num1:1,
						bg:'bgF0FBFB',
						status:0    // 0已处理  1未处理
					},
					{
						num:10,
						num1:1,
						bg:'bgFFF7F3',
						status:0

					},
					{
						num:10,
						num1:1,
						bg:'bgF0FBFB',
						status:0

					},
					{
						num:10,
						num1:1,
						bg:'bgFFF7F3',
						status:0

					},
					{
						num:10,
						num1:1,
						bg:'bgF0FBFB',
						status:0

					},
					{
						num:10,
						num1:1,
						bg:'bgFFF7F3',
						status:0

					},
					{
						num:10,
						num1:1,
						bg:'bgF0FBFB',
						status:0

					},
					{
						num:10,
						num1:1,
						bg:'bgFFF7F3',
						status:0

					},
					{
						num:10,
						num1:1,
						bg:'bgF0FBFB',
						status:0

					},
					{
						num:10,
						num1:1,
						bg:'bgFFF7F3',
						status:0

					},
					{
						num:10,
						num1:1,
						bg:'bgF0FBFB',
						status:0

					},
					{
						num:10,
						num1:1,
						bg:'bgFFF7F3',
						status:0

					},
					{
						num:10,
						num1:1,
						bg:'bgF0FBFB',
						status:0
					}
				],
				currentMenu:0,
				isHandle:0,
				goods:[],
				numberList:[1,2,3,4,5,6,7,8,9,'.',0],
				isPsdCorrect:false,
				iskeyboardShow:false,
				psd:'',
				psd2:'',
				npsd:'',
				npsd2:'',
				nrpsd:'',
				nrpsd2:'',
				placeholderPincode:'',
				placeholderNPincode:'New pincode',
				placeholderNRPincode:'Re-enter pincode',
				placeholderOPincode:'Old pincode',
				focusDatype:'',//光标所在的位置，获取到光标所在位置，给哪个输入框输入内容
				pincodeType:'',//pincode登录内容
				message: '',//pincode登录错误信息
				isDisable:false, //控制按钮多次点击禁用
				isClock:false, //是否上锁，禁止点击
				timeLock:0,//上锁时间
				timer:null,//定时器
				userName:'',//登录用户信息
				intervalId:null,//定时器id，刷新数据使用
				lastTime: null, //最后一次点击的时间
				currentTime: null, //当前点击的时间
				timeOut: 10 * 60 * 1000,//设置超时时间： 10分钟
				isShowLoginOut:false,//是否显示退出登录按钮
				isShowTypePincode1:false,//显示pincode输入框样式-1.pincode登录是否显示
				isShowTypePincode2:false,//显示pincode输入框样式-创建pincode是否显示
				isShowTypePincode3:false,//显示pincode输入框样式-修改pincode是否显示
				editText:'setting',//键盘文字显示
			},
			mounted: function () {
				//获取pincode显示得到样式
				var _this = this
				getData('product/loginInfo', '', function (res) {
					//获取登录信息
					if (res.result.user_name) {
						_this.userName = 'i am '+res.result.user_name
						_this.isShowLoginOut = true
					} else {
						//获取不到登录信息则弹出登录框
						_this.iskeyboardShow = true
						_this.isClock = true
					}
					if(res.result.is_has_pincode==1){
						_this.isShowTypePincode1 = true
						_this.pincodeType = 1 //默认显示pincode登录
						_this.focusDatype = 10 //默认可直接输入密码
					} else {
						_this.isShowTypePincode2 = true
						_this.pincodeType = 2 //默认显示创建pincode
					}
				});
				//获取加工日期
				getData('product/deliveryDate', '', function (res) {
					console.log(res);
					_this.list = res.result.list
					_this.choseDate1 = res.result.default
					_this.currentDay = res.result.default_k
					_this.logistic_delivery_date = _this.choseDate1.logistic_delivery_date
					//获取初始化数据
					if(_this.logistic_delivery_date){
						_this.inidata(_this.logistic_delivery_date)
					}
				});
			},
			methods:{
				//获取初始化数据
				inidata(logistic_delivery_date) {
					var _this = this
					getData('product/iniData', {"logistic_delivery_date":logistic_delivery_date}, function (res) {
						res = res.result
						console.log(res,res.all_customers)
						_this.splideData(res.all_customers,res.all_drivers)
						_this.driverOrderDoneNum = res.driver_order_count.order_done_count
						_this.driverOrderNum = res.driver_order_count.order_count
						_this.orderDoneNum = res.all_order_count.order_done_count
						_this.orderNum = res.all_order_count.order_count
						_this.menudata2 = res.goods
						if(_this.menudata2.length>0){
							_this.twoCateGoods(_this.menudata2[0].product_id)
						}
					});
				},
				//获取二级类目
				twoCateGoods(product_id){
					var _this = this
					var data = {
						"logistic_delivery_date":_this.logistic_delivery_date,
						"logistic_driver_no":_this.logistic_driver_no,
						"product_id":product_id
					}
					console.log('获取二级类目参数---',data);
					getData('product/changeGoods', data, function (res) {
						res = res.result
						_this.menudataTwoCate = res.goods_two_cate
						console.log('二级类目产品数据-----',_this.menudataTwoCate)
					});
				},
				// 定时刷新数据函数
				dataRefreh() {
					// 计时器正在进行中，退出函数
					if (this.intervalId != null) {
						return;
					}
					// 计时器为空，操作
					this.intervalId = setInterval(() => {
						console.log("刷新",new Date());
						this.currentTime = new Date().getTime();
						if(this.currentTime - this.lastTime > this.timeOut) {  //判断上次最后一次点击的时间和这次点击的时间间隔是否大于10分钟
							//超过操作时间，调用退出pincode接口，并弹出pincode登录框+上锁
							var _this = this
							getData('product/loginOutPincode', '', function (res) {
								_this.iskeyboardShow = true
								_this.isClock = true
								_this.psd=_this.psd2=_this.npsd=_this.npsd2=_this.nrpsd=_this.nrpsd2=''
								_this.message=''
								_this.isPsdCorrect=false
							});
						}
					}, 5000);
				},
				// 停止定时器
				clear() {
					clearInterval(this.intervalId); //清除计时器
					this.intervalId = null; //设置为null
				},
				//判断用户10分钟内是否有操作，无操作则需要上锁，弹出pincode登录框
				isDo() {
					this.lastTime = new Date().getTime(); //如果在10分钟内点击，则把这次点击的时间记录覆盖掉之前存的最后一次点击的时间
					console.log('最后一次点击时间----',this.lastTime);
				},
				changeStatus(source,status,index){
					if(status==1){
						if(source==0){
							this.handleList[index].status=0
						}else if(source==1){
							this.handleList1[index].status=0
						}else{
							this.handleList2[index].status=0
						}
					}
				},
				handle(index){  // 点击已处理
					this.currentHandlePop=index
				},
				Popcontinue(source,index){  // 变成待处理
					this.lastTime = new Date().getTime();//记录最后一次点击时间
					this.currentHandlePop=-1
					if(source==0){
						this.handleList[index].status=1
					}else if(source==1){
						this.handleList1[index].status=1
					}else{
						this.handleList2[index].status=1
					}
				},
				Popreturn(index){
					this.lastTime = new Date().getTime();//记录最后一次点击时间
					this.currentHandlePop=-1
				},
				clickGoods(item,index){
				   	this.currentContent=index
					if(item.status==0){
						this.menudata2[index].isBlink=true
					}
					//获取二级类目
					this.twoCateGoods(item.product_id)
				},
				tab(index){
					this.lastTime = new Date().getTime();//记录最后一次点击时间
					this.currentTab=index
					this.currentHandlePop=-1
				},
				add(source,index,sec){
					if(source==0){
						if(sec==0){
							this.handleList[index].num=this.numAdd(this.handleList[index].num,0.1)
						}else{
							this.handleList[index].num1++
						}
					}else if(source==1){
						if(sec==0){
							this.handleList1[index].num=this.numAdd(this.handleList1[index].num,0.1)
						}else{
							this.handleList1[index].num1++
						}
					}else{
						if(sec==0){
							this.handleList2[index].num=this.numAdd(this.handleList2[index].num,0.1)
						}else{
							this.handleList2[index].num1++
						}
					}
				},
				reduce(source,index,sec){
					if(source==0){
						if(sec==0){
							this.handleList[index].num=this.numSub(this.handleList[index].num,0.1)
						}else{
							this.handleList[index].num1--
						}
					}else if(source==1){
						if(sec==0){
							this.handleList1[index].num=this.numSub(this.handleList1[index].num,0.1)
						}else{
							this.handleList1[index].num1--
						}
					}else{
						if(sec==0){
							this.handleList2[index].num=this.numSub(this.handleList2[index].num,0.1)
						}else{
							this.handleList2[index].num1--
						}
					}
				},
				numSub(arg1,arg2){
				    var r1,r2,m;
				    try{r1=arg1.toString().split(".")[1].length}catch(e){r1=0}
				    try{r2=arg2.toString().split(".")[1].length}catch(e){r2=0}
				    m=Math.pow(10,Math.max(r1,r2))
				    return (arg1*m-arg2*m)/m;
				},
				numAdd(arg1, arg2) {
				    var r1, r2, m;
				    try { r1 = arg1.toString().split(".")[1].length; } catch (e) { r1 = 0; }
				    try { r2 = arg2.toString().split(".")[1].length; } catch (e) { r2 = 0; }
				    m = Math.pow(10, Math.max(r1, r2));
				    return (arg1 * m + arg2 * m) / m;
				},
				//切换日期
				choseDay(item,index){
					this.choseDate1=item
					this.currentDay=index
					this.whichPopShow=-1
					this.logistic_delivery_date=item.logistic_delivery_date
					this.inidata(this.logistic_delivery_date)
				},
				choseCus(item,index){
					this.choseDate2=item
					this.current2=index
					this.whichPopShow=-1
				},
				choseDriver(item,index){
					this.choseDate3=item
					this.current3=index
					this.whichPopShow=-1
					this.logistic_driver_no=item.logistic_driver_no
				},
				closePop(){
					this.whichPopShow=-1
				},
				chose(index){
					this.lastTime = new Date().getTime();//记录最后一次点击时间
					this.whichPopShow=index
				},
				returnPage(index){
					this.currentPage=index
				},
				clickMenu(index){
					this.currentMenu=index
				},
				clickHandle(){
					if(this.isHandle==2){
						this.isHandle=0
					}else{
						this.isHandle=this.isHandle+1
					}
				},
				cancelZD(index){
					this.goods.splice(index,1)
				},
				//光标移入div样式
				focusData(e,type,pincodeType){
					e.target.setAttribute('placeholder','')
					this.focusDatype = type
					this.pincodeType = pincodeType
				},
				//点击pincode键盘，显示输入pincode
				clickNum(number){
					this.lastTime = new Date().getTime();//记录最后一次点击时间
					switch(this.focusDatype){
						case 10:
							if(this.psd.length<4){
								this.psd+=number
								this.psd2 += new String('*',this.psd.length);
							}
							break;
						case 20:
							if(this.npsd.length<4){
								this.npsd+=number
								this.npsd2 += new String('*',this.npsd.length);
							}
							break;
						case 30:
							if(this.nrpsd.length<4){
								this.nrpsd+=number
								this.nrpsd2 += new String('*',this.nrpsd.length);
							}
							console.log(this.nrpsd,this.nrpsd.length);
							break;
					}
				},
				//上锁，则退出登录
				popKeyboard(){
					this.iskeyboardShow=true
					this.isClock = true
					this.psd=this.psd2=this.npsd=this.npsd2=this.nrpsd=this.nrpsd2=''
					this.message=''
					this.editText='setting'
					//退出pincode登录
					getData('product/loginOutPincode', '', function (res) {
					});
				},
				//关闭keyboard
				closeKeyboard(){
					if(!this.isClock){
						this.iskeyboardShow=false
					}
				},
				//弹出修改pincode
				editPincode(){
					this.lastTime = new Date().getTime();//记录最后一次点击时间
					this.isShowTypePincode1=!this.isShowTypePincode1
					this.isShowTypePincode3=!this.isShowTypePincode3
					if(this.isShowTypePincode1){
						this.pincodeType = 1
						this.focusDatype=10
						this.psd=this.psd2=this.npsd=this.npsd2=this.nrpsd=this.nrpsd2=''
						this.editText='setting'
					}
					if(this.isShowTypePincode3){
						this.pincodeType = 3
						this.focusDatype=''
						this.psd=this.psd2=''
						this.editText='Back'
					}
					this.message=''
					this.isPsdCorrect=false
				},
				//pincode登录
				save(){
					this.lastTime = new Date().getTime();//记录最后一次点击时间
					var _this = this
					if (_this.isDisable) {
						return
					}
					var data = {};
					var url = '';
					console.log(_this.pincodeType);
					switch(_this.pincodeType){
						case 1:
							if (_this.psd==''||_this.psd==null) {
								this.isPsdCorrect=true
								this.message='Please input pincode'
								return
							}
							data = {
								pincode: _this.psd,
							}
							url = 'product/loginByPincode'
							break;
						case 2:
							if (_this.npsd==''||_this.npsd==null) {
								this.isPsdCorrect=true
								this.message='Please input New pincode'
								$('.J_n_pincode').attr('placeholder',_this.placeholderNPincode);
								$('.J_nr_pincode').attr('placeholder',_this.placeholderNRPincode);
								return
							}
							if (_this.nrpsd==''||_this.nrpsd==null) {
								this.isPsdCorrect=true
								this.message='Please input Re-enter pincode'
								$('.J_n_pincode').attr('placeholder',_this.placeholderNPincode);
								$('.J_nr_pincode').attr('placeholder',_this.placeholderNRPincode);
								return
							}
							if(_this.npsd.length!=4||_this.nrpsd.length!=4){
								this.isPsdCorrect=true
								this.message='Please enter a 4-digit code'
								this.npsd=this.nrpsd=this.npsd2=this.nrpsd2=''
								$('.J_n_pincode').attr('placeholder',_this.placeholderNPincode);
								$('.J_nr_pincode').attr('placeholder',_this.placeholderNRPincode);
								return
							}
							data = {
								new_pincode: _this.npsd,
								sure_pincode: _this.nrpsd,
							}
							url = 'product/setPincode'
							break;
						case 3:
							if (_this.psd==''||_this.psd==null) {
								this.isPsdCorrect=true
								this.message='Please input Old pincode'
								$('.J_o_pincode').attr('placeholder',_this.placeholderOPincode);
								return
							}
							if (_this.npsd==''||_this.npsd==null) {
								this.isPsdCorrect=true
								this.message='Please input New pincode'
								$('.J_n_pincode').attr('placeholder',_this.placeholderNPincode);
								$('.J_nr_pincode').attr('placeholder',_this.placeholderNRPincode);
								return
							}
							if (_this.nrpsd==''||_this.nrpsd==null) {
								this.isPsdCorrect=true
								this.message='Please input Re-enter pincode'
								$('.J_n_pincode').attr('placeholder',_this.placeholderNPincode);
								$('.J_nr_pincode').attr('placeholder',_this.placeholderNRPincode);
								return
							}
							if(_this.npsd.length!=4||_this.nrpsd.length!=4){
								this.isPsdCorrect=true
								this.message='Please enter a 4-digit code'
								this.npsd=this.nrpsd=this.npsd2=this.nrpsd2=''
								$('.J_n_pincode').attr('placeholder',_this.placeholderNPincode);
								$('.J_nr_pincode').attr('placeholder',_this.placeholderNRPincode);
								return
							}
							data = {
								pincode: _this.psd,
								new_pincode: _this.npsd,
								sure_pincode: _this.nrpsd,
							}
							url = 'product/editPincode'
							break;
					}
					_this.isDisable = true
					console.log(url,data);
					getData(url, data, function (res) {
						console.log(res);
						_this.isDisable = false
						if(res.status == 200){
							console.log(res.result.user_name);
							if (res.result.user_name) {
								_this.userName = 'i am '+res.result.user_name
							}
							//登录成功，隐藏密码框
							_this.iskeyboardShow=false
							_this.isClock=false
							//显示退出登录按钮
							_this.isShowLoginOut = true
							//还原默认显示pincode登录
							_this.isShowTypePincode1 = true
							_this.isShowTypePincode2 = _this.isShowTypePincode3 = false
							_this.pincodeType = 1 //默认显示pincode登录
							_this.focusDatype = 10 //默认可直接输入密码
						} else {
							_this.message = res.message
							_this.isPsdCorrect=true
							switch(res.status){
								case 104:
									$('.J_pincode').attr('placeholder',_this.placeholderPincode);
									_this.psd=_this.psd2=''
									break;
								case 105://pincode错误次数过多，屏幕锁屏1分钟
									$('.J_pincode').attr('placeholder',_this.placeholderPincode);
									_this.psd=_this.psd2=''
									_this.isDisable = true
									_this.isClock = true
									_this.timeLock = 60
									_this.getTimeDown()
									break;
								case 106://pincode已存在
								case 108://pincode两次输入不一致
									$('.J_n_pincode').attr('placeholder',_this.placeholderNPincode);
									$('.J_nr_pincode').attr('placeholder',_this.placeholderNRPincode);
									_this.npsd=_this.npsd2=_this.nrpsd=_this.nrpsd2=''
									break;
								case 107:
									$('.J_o_pincode').attr('placeholder',_this.placeholderOPincode);
									_this.psd=_this.psd2=''
									break;
							}
						}
					});
				},
				//退出登录
				LogOut(){
					var _this = this
					if (_this.isDisable) {
						return
					}
					_this.isDisable = true
					getData('product/loginOut', '', function (res) {
						window.location.href = common.webUrl+'product/login';
					})
				},
				//删除code
				deletePsd(){
					this.lastTime = new Date().getTime();//记录最后一次点击时间
					switch(this.focusDatype){
						case 10:
							this.psd=this.psd.substr(0, this.psd.length - 1);
							this.psd2=this.psd2.substr(0, this.psd2.length - 1);
							break;
						case 20:
							this.npsd=this.npsd.substr(0, this.npsd.length - 1);
							this.npsd2=this.npsd2.substr(0, this.npsd2.length - 1);
							break;
						case 30:
							this.nrpsd=this.nrpsd.substr(0, this.nrpsd.length - 1);
							this.nrpsd2=this.nrpsd2.substr(0, this.nrpsd2.length - 1);
							break;
					}
				},
				//倒计时
				getTimeDown(){
					if (!this.timer) {
						this.timer = setInterval(() => {
							if (this.timeLock > 0) {
								this.timeLock--;
							} else {
								this.isDisable = !this.isDisable
								this.timeLock = 0
								console.log(this.isDisable,this.isClock);
								clearInterval(this.timer);
								this.timer = null;
							}
						}, 1000)
					}
				},
				//拼接数据
				splideData(all_customers,all_drivers){
					all_customers.unshift("All customers")
					all_drivers.unshift({"logistic_driver_no":"","name":"All drivers","nickname":""})
					this.list2 = all_customers
					this.list3 = all_drivers
				}
			},
			created(){
				this.lastTime = new Date().getTime();   //网页第一次打开时，记录当前时间
				this.dataRefreh();
			},
			destroyed(){
				// 在页面销毁后，清除计时器
				this.clear();
			}
		})
	</script>
</html>
